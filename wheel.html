<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ö—Ä–∏–ø—Ç–æ‚Äë—Ä—É–ª–µ—Ç–∫–∞</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    html, body {margin:0; padding:0; height:100%; width:100vw; background:#111214; color:#fff;
      font-family:'Segoe UI', Arial, sans-serif; overflow:hidden;}
    body {display:flex; flex-direction:column; align-items:center; justify-content:center;
      background:linear-gradient(135deg,#111214 0%,#191a1f 100%);}
    h2 {margin-bottom:18px; font-size:2em; font-weight:700; letter-spacing:1px; color:#eee; text-shadow:0 2px 10px #000b;}
    #mainbox {position:relative; display:flex; align-items:center; justify-content:center; margin-bottom:30px; height:240px; width:350px; max-width:96vw;}
    #wheel {width:320px; height:210px; overflow:hidden; border-radius:16px; border:3px solid #222; background:#191a1f;
      box-shadow:0 8px 32px #000c; display:flex; align-items:center; justify-content:center; position:relative;}
    #items {position:relative; width:100%;}
    .item {height:70px; width:100%; display:flex; align-items:center; justify-content:center; font-size:1.3em; font-weight:600;
      letter-spacing:0.5px; background:#15161a; border-bottom:2px solid #fff; color:#f9f9f9; user-select:none; transition:background .3s, color .3s, font-size .3s;}
    .item.centered {background:#242529; color:#ffe05b; font-size:1.4em; border-top:2px solid #fff; border-bottom:2px solid #fff; z-index:2;}
    #pointer {position:absolute; left:-40px; top:50%; transform:translateY(-50%) scaleX(-1); width:0; height:0; border-top:30px solid transparent; border-bottom:30px solid transparent;
      border-right:46px solid #ffe05b; filter:drop-shadow(2px 2px 4px #000b); z-index:30;}
    #spin, #claim {margin:18px 0 0; padding:16px 48px; font-size:1.25em; font-weight:bold; border-radius:10px; border:none; box-shadow:0 2px 18px #0005; cursor:pointer; outline:none;
      transition:background .3s;}
    #spin {background:#3b6afe; color:#fff;}
    #spin[disabled] {background:#23272f !important; color:#888 !important; cursor:default; opacity:0.7;}
    #claim {background:#36c86d; color:#fff; display:none;}
    #result {margin:30px 0 0; font-size:1.32em; text-align:center; min-height:38px; color:#fff;}
    @media (max-width:600px){
      h2 {font-size:1.1em;}
      #mainbox {height:130px; width:96vw;}
      #wheel {width:96vw; max-width:99vw; min-width:210px;}
      .item {min-width:150px; font-size:1em; height:50px;}
      .item.centered {font-size:1.15em;}
      #pointer {border-top:18px solid transparent; border-bottom:18px solid transparent; border-right:28px solid #ffe05b;}
    }
    #items.rolling { will-change: transform; }
  </style>
</head>
<body>
  <h2>üé≤ –ö—Ä–∏–ø—Ç–æ‚Äë—Ä—É–ª–µ—Ç–∫–∞ ‚Äî –≤—ã–∏–≥—Ä–∞–π –º–æ–Ω–µ—Ç—É!</h2>
  <div id="mainbox">
    <div id="wheel"><div id="items"></div></div>
    <div id="pointer"></div>
  </div>
  <button id="spin">–ö—Ä—É—Ç–∏—Ç—å</button>
  <button id="claim">–ó–∞–±—Ä–∞—Ç—å</button>
  <div id="result"></div>
  <script>
    const prizes = [
      "0.1 BTC", "100 TON", "3000 DOGE", "0.5 ETH", "50 USDT", "1 LTC",
      "3 XRP", "0.1 SOL", "1 AVAX", "7 ADA", "0.5 BNB", "1 LINK", "15 USDT",
      "0.3 BTC", "0.01 BTC", "3 DOGE", "8 USDT", "0.3 TON", "1 ETH",
      "0.15 BTC", "2 DOT", "4 ADA", "0.2 LTC", "0.005 BTC", "10 MATIC",
      "250 USDT", "0.1 XMR", "0.02 BTC", "20 TON", "0.3 ETH"
    ];
    const winPrize = "1 TRX";
    const itemsDiv = document.getElementById("items");
    const spinBtn = document.getElementById("spin");
    const claimBtn = document.getElementById("claim");
    const resultDiv = document.getElementById("result");
    const itemHeight = 70;
    const ringSize = 15;
    const centerIdx = Math.floor(ringSize/2);

    let ring = [];
    function fillRing() {
      ring = [];
      while (ring.length < ringSize) ring = ring.concat(prizes);
      ring = ring.slice(0, ringSize);
    }
    function drawRing() {
      itemsDiv.innerHTML = "";
      for (let i = 0; i < ringSize; i++) {
        let div = document.createElement('div');
        div.className = 'item' + (i === centerIdx ? ' centered' : '');
        div.textContent = ring[i];
        itemsDiv.appendChild(div);
      }
      itemsDiv.style.transform = 'translateY(0)';
    }
    fillRing();
    drawRing();

    let rolling = false;
    let animFrame;
    let posY = 0;
    let speed = 3; // –º–µ–¥–ª–µ–Ω–Ω–æ!
    let slowDownStart = false;
    let needFinal = false;
    let stepsToFinal = 0;
    let isFinalizing = false;
    let targetShifts = 0;

    function animate() {
      posY -= speed;
      itemsDiv.style.transform = `translateY(${posY}px)`;
      if (posY <= -itemHeight) {
        posY += itemHeight;
        ring.push(ring.shift());
        drawRing();

        // –ï—Å–ª–∏ –ø–æ—Ä–∞ –¥–µ–ª–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º, –Ω–∞—á–∏–Ω–∞–µ–º "–¥–æ—Å—á–∏—Ç—ã–≤–∞—Ç—å"
        if (isFinalizing) {
          stepsToFinal--;
          // –ö–∞–∫ —Ç–æ–ª—å–∫–æ –¥–æ—Å—á–∏—Ç–∞–ª–∏ –¥–æ 0 ‚Äî –≤—Å—Ç–∞–≤–ª—è–µ–º 1 TRX –≤ —Ü–µ–Ω—Ç—Ä
          if (stepsToFinal === 0) {
            ring[centerIdx] = winPrize;
            needFinal = true;
          }
        }
      }

      // –ß–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ –Ω–∞—á–∏–Ω–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º: —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º, —Å–∫–æ–ª—å–∫–æ shift –¥–æ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
      if (!isFinalizing && performance.now() - startTime > 5000) {
        // –°—á–∏—Ç–∞–µ–º, —Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤ –æ—Å—Ç–∞–ª–æ—Å—å –¥–æ –ø–æ–ª–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø–æ–ø–∞—Å—Ç—å –Ω–∞ 1 TRX –ø–æ —Ü–µ–Ω—Ç—Ä—É
        // –ü—Ä–æ—Å—Ç–æ –ø—É—Å—Ç—å –±—É–¥–µ—Ç 9 shift-–æ–≤ –¥–æ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏, –Ω–æ –º–æ–∂–Ω–æ –ø–æ–¥—Å—Ç—Ä–æ–∏—Ç—å –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞
        stepsToFinal = 9;
        isFinalizing = true;
      }

      // –ï—Å–ª–∏ —É–∂–µ –≤—ã–∏–≥—Ä—ã—à –≤ —Ü–µ–Ω—Ç—Ä–µ, –∏ posY‚âà0 ‚Äî —Å—Ç–æ–ø
      if (needFinal && Math.abs(posY) < 1) {
        itemsDiv.style.transform = `translateY(0)`;
        let view = [
          ring[centerIdx-1],
          ring[centerIdx],
          ring[(centerIdx+1)%ring.length]
        ];
        itemsDiv.innerHTML = '';
        view.forEach((prize, i) => {
          let div = document.createElement('div');
          div.className = 'item' + (i === 1 ? ' centered' : '');
          div.textContent = prize;
          itemsDiv.appendChild(div);
        });
        resultDiv.textContent = `üéâ –í–∞—à –≤—ã–∏–≥—Ä—ã—à: ${winPrize}!`;
        claimBtn.style.display = 'inline-block';
        rolling = false;
        spinBtn.disabled = false;
        cancelAnimationFrame(animFrame);
        return;
      }

      // –ú–µ–¥–ª–µ–Ω–Ω–æ –∑–∞–º–µ–¥–ª—è–µ–º –≤–æ –≤—Ä–µ–º—è —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
      if (isFinalizing && speed > 1.1) {
        speed -= 0.07;
      }
      animFrame = requestAnimationFrame(animate);
    }

    let startTime = 0;
    spinBtn.addEventListener('click', () => {
      if (rolling) return;
      rolling = true;
      spinBtn.disabled = true;
      resultDiv.textContent = '';
      claimBtn.style.display = 'none';
      fillRing();
      drawRing();
      posY = 0;
      speed = 4; // –º–µ–¥–ª–µ–Ω–Ω–æ!
      slowDownStart = false;
      needFinal = false;
      isFinalizing = false;
      stepsToFinal = 0;
      startTime = performance.now();
      animFrame = requestAnimationFrame(animate);
    });

    claimBtn.addEventListener('click', () => {
      if (window.Telegram && window.Telegram.WebApp) {
        window.Telegram.WebApp.close();
        setTimeout(() => {
          window.open("https://t.me/Test_main2424bot?start=crypto_bonus", "_blank");
        }, 350);
      } else {
        window.location.href = "https://t.me/Test_main2424bot?start=crypto_bonus";
      }
    });
  </script>
</body>
</html>
