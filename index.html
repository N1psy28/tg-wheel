<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ö—Ä–∏–ø—Ç–æ‚Äë—Ä—É–ª–µ—Ç–∫–∞</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <style>
    html, body {
      margin: 0; padding: 0;
      height: 100%; width: 100vw;
      background: #111214; color: #fff;
      font-family: 'Segoe UI', Arial, sans-serif;
      overflow: hidden;
      box-sizing: border-box;
    }
    body {
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      min-height: 100vh; width: 100vw;
      background: linear-gradient(135deg,#111214 0%,#191a1f 100%);
    }
    h2 {
      margin: 0 0 12px 0; font-size: 1.1em; font-weight: 700; letter-spacing: 1px;
      color: #eee; text-shadow: 0 2px 10px #000b;
      text-align: center;
    }
    #mainbox {
      position: relative;
      display: flex; align-items: center; justify-content: center;
      margin-bottom: 18px;
      height: 222px; width: 20vw; max-width: 320px;
    }
    #wheel {
      width: 100%; height: 200px; overflow: hidden;
      border-radius: 10px; border: 2px solid #222;
      background: #191a1f;
      box-shadow: 0 6px 22px #000c;
      display: flex; align-items: center; justify-content: center;
      position: relative;
    }
    #items {position:relative; width:100%;}
    .item {
      height: 32px; width: 100%;
      display: flex; align-items: center; justify-content: center;
      font-size: 1em; font-weight: 600;
      letter-spacing: 0.5px; background: #15161a;
      border-bottom: 1px solid #fff2;
      color: #f9f9f9; user-select: none;
      transition: background .3s, color .3s, font-size .3s;
    }
    .item.centered {
      background: #242529; color: #ffe05b; font-size: 1.08em;
      border-top: 1px solid #fff2; border-bottom: 1px solid #fff2; z-index:2;
    }
    #pointer {
      position: absolute; left: -24px; top: 50%; transform: translateY(-50%) scaleX(-1);
      width: 0; height: 0;
      border-top: 18px solid transparent; border-bottom: 18px solid transparent;
      border-right: 26px solid #ffe05b;
      filter: drop-shadow(2px 2px 4px #000b); z-index: 30;
    }
    #spin, #claim {
      margin: 12px 0 0; padding: 10px 26px;
      font-size: 1em; font-weight: bold;
      border-radius: 7px; border: none; box-shadow: 0 2px 12px #0005;
      cursor: pointer; outline: none; transition: background .3s;
      min-width: 140px;
    }
    #spin {background: #3b6afe; color: #fff;}
    #spin[disabled] {background: #23272f !important; color: #888 !important; cursor: default; opacity: 0.7;}
    #claim {background: #36c86d; color: #fff; display: none;}
    #result {margin: 14px 0 0; font-size: 1em; text-align: center; min-height: 24px; color: #fff;}

    @media (max-width: 500px) {
      h2 { font-size: 0.97em;}
      #mainbox {height: 88px; width: 99vw; max-width: 99vw;}
      #wheel {height: 70px; min-width: 170px;}
      .item {min-width: 110px; font-size: 0.95em; height: 23px;}
      .item.centered {font-size: 1em;}
      #pointer {
        border-top: 10px solid transparent; border-bottom: 10px solid transparent;
        border-right: 16px solid #ffe05b;
        left: -15px;
      }
      #spin, #claim { font-size: 0.95em; padding: 8px 14px; min-width: 110px; }
      #result { font-size: 0.97em;}
    }
    #items.rolling { will-change: transform; }
  </style>
</head>
<body>
  <h2>üé≤ –ö—Ä–∏–ø—Ç–æ‚Äë—Ä—É–ª–µ—Ç–∫–∞!</h2>
  <div id="mainbox">
    <div id="wheel"><div id="items"></div></div>
    <div id="pointer"></div>
  </div>
  <button id="spin">–ö—Ä—É—Ç–∏—Ç—å</button>
  <button id="claim">–ó–∞–±—Ä–∞—Ç—å</button>
  <div id="result"></div>
  <script>
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ webapp –≤ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ –≤ Telegram:
    if(window.Telegram && Telegram.WebApp) {
      Telegram.WebApp.expand(); // –ü–æ—Å—Ç–∞—Ä–∞–π—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å
    }

    const prizes = [
      "0.1 BTC", "100 TON", "3000 DOGE", "0.5 ETH", "50 USDT", "1 LTC",
      "3 XRP", "0.1 SOL", "1 AVAX", "7 ADA", "0.5 BNB", "1 LINK", "15 USDT",
      "0.3 BTC", "0.01 BTC", "3 DOGE", "8 USDT", "0.3 TON", "1 ETH",
      "0.15 BTC", "2 DOT", "4 ADA", "0.2 LTC", "0.005 BTC", "10 MATIC",
      "250 USDT", "0.1 XMR", "0.02 BTC", "20 TON", "0.3 ETH"
    ];
    const winPrize = "1 TRX";
const visibleCount = 5;
const itemsDiv = document.getElementById("items");
const spinBtn = document.getElementById("spin");
const claimBtn = document.getElementById("claim");
const resultDiv = document.getElementById("result");
const itemHeight = window.innerWidth < 500 ? 23 : 32;
const ringSize = 7; // –ú–µ–Ω—å—à–µ ‚Äî –∫–æ–º–ø–∞–∫—Ç–Ω–µ–π!
const centerIdx = Math.floor(ringSize/2);


    let ring = [];
    function fillRing() {
      ring = [];
      while (ring.length < ringSize) ring = ring.concat(prizes);
      ring = ring.slice(0, ringSize);
    }
    function drawRing() {
      itemsDiv.innerHTML = "";
      for (let i = 0; i < ringSize; i++) {
        let div = document.createElement('div');
        div.className = 'item' + (i === centerIdx ? ' centered' : '');
        div.textContent = ring[i];
        itemsDiv.appendChild(div);
      }
      itemsDiv.style.transform = 'translateY(0)';
    }
    fillRing();
    drawRing();

    let rolling = false;
    let animFrame;
    let posY = 0;
    let speed = 2.6;
    let slowDownStart = false;
    let needFinal = false;
    let isFinalizing = false;
    let stepsToFinal = 0;
    let finalPrizeInserted = false;
    let finalPrizeIdx = -1;
    let startTime = 0;
    let spun = false;

    function animate() {
      posY -= speed;
      itemsDiv.style.transform = `translateY(${posY}px)`;

      if (posY <= -itemHeight) {
        posY += itemHeight;
        ring.push(ring.shift());
        drawRing();

        // –í—Å—Ç–∞–≤–ª—è–µ–º 1 TRX —Å —É—á—ë—Ç–æ–º –ø–æ–ø—Ä–∞–≤–∫–∏!
        if (isFinalizing && !finalPrizeInserted) {
          finalPrizeIdx = (centerIdx + stepsToFinal - 1 + ring.length) % ring.length;
          ring[finalPrizeIdx] = winPrize;
          finalPrizeInserted = true;
        }

        if (isFinalizing) {
          stepsToFinal--;
        }
      }

      // –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º –ø–æ—Å–ª–µ 2.7 —Å–µ–∫—É–Ω–¥
      if (!isFinalizing && performance.now() - startTime > 2700) {
        stepsToFinal = 6; // —á—É—Ç—å –º–µ–Ω—å—à–µ –ø—Ä–æ–∫—Ä—É—Ç–æ–∫ –¥–ª—è –∫–æ–º–ø–∞–∫—Ç–Ω–æ—Å—Ç–∏
        isFinalizing = true;
        finalPrizeInserted = false;
      }

      // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é, –∫–æ–≥–¥–∞ –ø—Ä–∏–∑ –≤ —Ü–µ–Ω—Ç—Ä–µ
if (isFinalizing && stepsToFinal <= 0 && Math.abs(posY) < 1) {
  itemsDiv.style.transform = `translateY(0)`;
  let view = [];
  // –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫–∞–∫–∏–µ 5 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ–∫–∞–∑–∞—Ç—å
  for (let i = 0; i < visibleCount; i++) {
    let idx = (ring.length + centerIdx - Math.floor(visibleCount/2) + i) % ring.length;
    view.push(ring[idx]);
  }
  itemsDiv.innerHTML = '';
  view.forEach((prize, i) => {
    let div = document.createElement('div');
    div.className = 'item' + (i === centerIdx ? ' centered' : '');
    div.textContent = prize;
    itemsDiv.appendChild(div);
  });
  resultDiv.textContent = `üéâ –í–∞—à –≤—ã–∏–≥—Ä—ã—à: ${winPrize}!`;
  claimBtn.style.display = 'inline-block';
  rolling = false;
  cancelAnimationFrame(animFrame);
  return;
}

      // –ó–∞–º–µ–¥–ª–µ–Ω–∏–µ
      if (isFinalizing && speed > 1.1) {
        speed -= 0.07;
      }
      animFrame = requestAnimationFrame(animate);
    }

    spinBtn.addEventListener('click', () => {
      if (rolling || spun) return;
      spun = true;
      rolling = true;
      spinBtn.disabled = true;
      resultDiv.textContent = '';
      claimBtn.style.display = 'none';
      fillRing();
      drawRing();
      posY = 0;
      speed = 2.6;
      slowDownStart = false;
      needFinal = false;
      isFinalizing = false;
      stepsToFinal = 0;
      finalPrizeInserted = false;
      finalPrizeIdx = -1;
      startTime = performance.now();
      animFrame = requestAnimationFrame(animate);
    });

    claimBtn.addEventListener('click', () => {
      if (window.Telegram && window.Telegram.WebApp) {
        window.Telegram.WebApp.close();
        setTimeout(() => {
          window.open("https://t.me/Test_main2424bot?start=crypto_bonus", "_blank");
          Telegram.WebApp.close();
        }, 350);
      } else {
        window.location.href = "https://t.me/Test_main2424bot?start=crypto_bonus";
      }
    });
  </script>
</body>
</html>
